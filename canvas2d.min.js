function _setContainer(t,e){t.width=e.width,t.height=e.height,t.stage=e.container,t.canvas.width=e.width,t.canvas.height=e.height,t.ctx=t.canvas.getContext("2d")}var Canvas2d={globalId:1,container:{id:0,width:0,height:0,element:null},fakeCtx:null,wn:null};Canvas2d.Stage=function(t,e,i,s){this.enabledEvent=s!==!1||s,this.className="Stage",this.visible=!0,this.date=new Date,this.name="Stage_"+this.date.getTime().toString(),this.indexCount=0,this.container=document.getElementById(t),this.container.style.width=e+"px",this.container.style.height=i+"px",this.container.style.position="absolute",this.container.onmousedown=function(){},Canvas2d.container.id=t,Canvas2d.container.width=e,Canvas2d.container.height=i,Canvas2d.container.element=this.container,this.fakeCanvas=document.createElement("canvas"),this.fakeCanvas.width=e,this.fakeCanvas.height=i,this.fakeCtx=this.fakeCanvas.getContext("2d"),Canvas2d.fakeCtx=this.fakeCtx,this.width=e,this.height=i,this.x=0,this.y=0,this.alpha=1,this.scaleX=1,this.scaleY=1,this.rotation=0,this.id=t,this.index=0,this.children=[],this.evtListeners={};var a=navigator.userAgent.toLowerCase();this.agent=a,this.enabledEvent&&("ontouchstart"in window?this._functestmobile():this._functest()),Canvas2d.wn=(new Date).getTime(),this.wn=Canvas2d.wn,window.fire=function(t){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),window.cancelFire=function(t){return window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||function(t){window.clearTimeout(t)}}(),window[Canvas2d.wn+"rqanim"]={time:0,timeInterval:0,startTime:0,lastTime:0,frame:0,animating:!1,loop:[],prId:0,whipe:function(){this.loop=[]},getLoop:function(){return this.loop},getTime:function(){return this.time},getFps:function(){return this.timeInterval>0?1e3/this.timeInterval:0},getFrame:function(){return this.frame},getTimeInterval:function(){return this.timeInterval},_animationLoop:function(){if(this.animating){var t=this;this.frame++;var e=new Date,i=e.getTime();this.timeInterval=i-this.lastTime,this.time+=this.timeInterval,this.lastTime=i;for(var s=0;s<this.loop.length;s++){var a=this.loop[s];a.func.apply(a.target,[a.target])}window.fire(function(){t._animationLoop()})}},start:function(){if(!this.animating){var t=new Date;this.startTime=t.getTime(),this.lastTime=this.startTime,this.animating=!0,this._animationLoop()}},reset:function(){this.time=0,this.timeInterval=0,this.startTime=0,this.lastTime=0,this.frame=0;var t=new Date;this.startTime=t.getTime(),this.lastTime=this.startTime},stop:function(){this.animating=!1},addLoop:function(t,e){var i=!0;return"DisplayObjects"===t.className?i=t.parent.parent.wn===Canvas2d.wn:"Sprite"===t.className?i=t.parent.wn===Canvas2d.wn:"Stage"===t.className&&(i=t.wn===Canvas2d.wn),!this.isChild(t)&&i&&(this.prId++,this.start(),t.PRID=this.prId,this.loop.push({target:t,func:e,id:this.prId})),this.prId},isChild:function(t){for(var e=!1,i=0;i<this.loop.length;i++)if(this.loop[i].target===t){e=!0;break}return e},removeLoop:function(t){for(var e=-1,i=0;i<this.loop.length;i++)if(this.loop[i].id===t.PRID){e=i;break}e>-1&&this.loop.splice(e,1),0===this.loop.length&&this.stop()},_init:function(){var t=new Date;this.startTime=t.getTime(),this.lastTime=this.startTime,this.animating=!0,this._animationLoop()}}},Canvas2d.Stage.prototype={enableEvt:function(){"ontouchstart"in window?this._functestmobile():this._functest(),this.enabledEvent=!0},disableEvt:function(){"ontouchstart"in window?(this.container.removeEventListener("touchmove",this._evtData[0],!1),this.container.removeEventListener("touchstart",this._evtData[0],!1),this.container.removeEventListener("touchend",this._evtData[0],!1)):(this.container.removeEventListener("mousemove",this._evtData[0],!1),this.container.removeEventListener("mousedown",this._evtData[0],!1),this.container.removeEventListener("mouseup",this._evtData[0],!1),this.container.removeEventListener("click",this._evtData[0],!1),this.container.removeEventListener("mouseover",this._evtData[1],!1),this.container.removeEventListener("mouseout",this._evtData[1],!1)),this.enabledEvent=!1},addLoop:function(t,e){window[Canvas2d.wn+"rqanim"].addLoop(t,e)},removeLoop:function(t){window[Canvas2d.wn+"rqanim"].removeLoop(t)},start:function(){window[Canvas2d.wn+"rqanim"].start()},reset:function(){window[Canvas2d.wn+"rqanim"].reset()},stop:function(){window[Canvas2d.wn+"rqanim"].animating=!1},getFrame:function(){return window[Canvas2d.wn+"rqanim"].getFrame()},getTime:function(){return window[Canvas2d.wn+"rqanim"].getTime()},getFps:function(){return window[Canvas2d.wn+"rqanim"].getFps()},getTimeInterval:function(){return window[Canvas2d.wn+"rqanim"].getTimeInterval()},getLoopList:function(){return window[Canvas2d.wn+"rqanim"].loop},isAnimating:function(){return window[Canvas2d.wn+"rqanim"].animating},getDataURL:function(t,e){var i=t?t:"image/jpeg",s=e?e:5;this.fakeCtx.save(),this.draw(this.fakeCtx),this.fakeCtx.restore();var a=this.fakeCanvas.toDataURL(i,s);this.fakeCtx.clearRect(0,0,this.width,this.height);var n=document.createElement("img");return n.src=a,n},addEvent:function(t,e){t in this.evtListeners?this.evtListeners[t].func.push(e):this.evtListeners[t]={func:[e]}},removeEvent:function(t,e){if(t in this.evtListeners){for(var i=0;i<this.evtListeners[t].func.length;i++)if(this.evtListeners[t].func[i]===e){this.evtListeners[t].func.splice(i,1);break}0===this.evtListeners[t].func.length&&delete this.evtListeners[t]}},add:function(t){t.parent||"DisplayObjects"===t.className||(t.index=this.indexCount,t.parent=this,this._setContainer(t,this),this.children.push(t),this.indexCount++,this._orderCanvases())},remove:function(t){if(t.parent===this){t.parent=void 0,this.children.splice(t.index,1),this.container.removeChild(t.canvas),this.indexCount--;for(var e=0;e<this.children.length;e++)this.children[e].index=e;this._orderCanvases()}},zOrder:function(t,e){if(t.parent===this)if("string"==typeof e){var i=this.children.length,s="top"===e?i-1:"bottom"===e?0:i-1;this.children.splice(t.index,1),this.children.splice(s,0,t);for(var a=0;a<i;a++)this.children[a].index=a;this._orderCanvases()}else if(e in this.children){this.children.splice(t.index,1),this.children.splice(e,0,t);for(var a=0;a<this.children.length;a++)this.children[a].index=a;this._orderCanvases()}},_setContainer:function(t,e){t.width=e.width,t.height=e.height,t.stage=e.container,t.canvas.width=e.width,t.canvas.height=e.height,t.ctx=t.canvas.getContext("2d")},_orderCanvases:function(){function t(i){for(var s=0;s<i.length;s++)"Sprite"===i[s].className?e.container.appendChild(i[s].canvas):t(i[s].children)}var e=this;t(this.children)},resize:function(t,e){this.container.style.width=t+"px",this.container.style.height=e+"px",this.width=t,this.height=e;for(var i=0;i<this.children.length;i++)this._setContainer(this.children[i],this)},_functestmobile:function(){function t(t){if(t.preventDefault(),q.touchend=!1,q.click=!1,q.dragstop=!1,q.gestureend=!1,q.touchmove="touchmove"===t.type,"touchstart"===t.type?q.touchstart=!0:q.touchstart&&"touchend"===t.type&&(q.touchstart=!1,q.touchend=!0,q.click=!0,C=!1,x=!1,I=!1,S=!1,M=1,k=0,L=0),q.touchmove&&e(t)?(g&&O._testdetect(t.touches[0],g)&&O._testdetect(t.touches[1],g)?(X=g,Y=v):X=Y=!1,C=!x,_=!0):q.touchmove&&g&&(S=!I,T=!0),C&&(x=!0),S&&g&&(I=!0),!S&&!I&&T&&q.touchend&&(q.dragstop=!0,T=!1),(Y||X)&&(C&&Y?a(t,Y,t):x&&Y&&s(t,Y,t),C&&X?a(t,X,t):x&&X&&s(t,X,t)),C?a(t,O,t):x?s(t,O,t):_&&i(h(t),"gestureend",t),!C&&!x&&_&&q.touchend&&(q.gestureend=!0,_=!1),S&&v){var l=O._parentOffset(h(t),v.parent);b=l.ox-v.x,y=l.oy-v.y,n(t,v,l)}else I&&v&&r(h(t),v,t,b,y);if(S&&g){var c=O._parentOffset(h(t),g.parent);m=c.ox-g.x,w=c.oy-g.y,n(t,g,c)}else I&&g&&r(h(t),g,t,m,w);for(var d in q)if(q[d])switch(d){case"touchend":o(h(t),d,"mouseup",t);break;case"touchstart":o(h(t),d,"mousedown",t);break;case"touchmove":o(h(t),d,"mousemove",t);break;default:o(h(t),d,"none",t)}}function e(t){return"touchend"!==t.type&&2===t.touches.length}function i(t,e,i){if(e in O.evtListeners)for(p=O._parentOffset(t,O),c=0;c<O.evtListeners[e].func.length;c++)O.evtListeners[e].func[c].apply(O,[{target:O,mouse:p,type:e,event:i}])}function s(t,e,i){if("gesturechange"in e.evtListeners){var s,a,n=e===O?O:e.parent;s=O._parentOffset(t.touches[0],n),a=O._parentOffset(t.touches[1],n);var r,h,o,l;for(h=Math.sqrt(Math.pow(s.x-a.x,2)+Math.pow(s.y-a.y,2)),r=Math.atan2(s.y-a.y,s.x-a.x),o=M*(h/L),l=r-k,s.mouse2=a,s.scale=o,s.angle=l,c=0;c<e.evtListeners.gesturechange.func.length;c++)e.evtListeners.gesturechange.func[c].apply(f,[{target:e,mouse:s,type:"gesturechange",event:t}])}}function a(t,e,i){var s,a,n=e===O?O:e.parent;if(s=O._parentOffset(t.touches[0],n),a=O._parentOffset(t.touches[1],n),L=Math.sqrt(Math.pow(s.x-a.x,2)+Math.pow(s.y-a.y,2)),k=Math.atan2(s.y-a.y,s.x-a.x)-e.rotation,M=(e.scaleX+e.scaleY)/2,"gesturestart"in e.evtListeners)for(s.mouse2=a,s.scale=M,s.angle=k,c=0;c<e.evtListeners.gesturestart.func.length;c++)e.evtListeners.gesturestart.func[c].apply(f,[{target:e,mouse:s,type:"gesturestart",event:t}])}function n(t,e,i){if("dragstart"in e.evtListeners)for(c=0;c<e.evtListeners.dragstart.func.length;c++)e.evtListeners.dragstart.func[c].apply(f,[{target:e,mouse:i,type:"dragstart",event:t}])}function r(t,e,i,s,a){if("drag"in e.evtListeners){var n,r,h=O._parentOffset(t,e.parent);for(n=h.ox-s,r=h.oy-a,h.ox=n,h.oy=r,c=0;c<e.evtListeners.drag.func.length;c++)e.evtListeners.drag.func[c].apply(f,[{target:e,mouse:h,type:"drag",event:i}])}}function h(t){var e={pageX:0,pageY:0};return t.touches&&t.touches.length>0?e=t.touches[0]:t.changedTouches&&t.changedTouches.length>0&&(e=t.changedTouches[0]),e}function o(t,e,i,s,a){for(l=O.children.length-1;l>-1;l--)if(u=O.children[l],u.visible&&u.enabledEvent){for(d=u.children.length-1;d>-1;d--){if(f=u.children[d],f.visible&&f.enabledEvent){var n=O._testdetect(t,f);if(n){if(e in f.evtListeners)for(c=0;c<f.evtListeners[e].func.length;c++)f.evtListeners[e].func[c].apply(f,[{target:f,mouse:n,type:e,event:s}]);if(i in f.evtListeners)for(c=0;c<f.evtListeners[i].func.length;c++)f.evtListeners[i].func[c].apply(f,[{target:f,mouse:n,type:i,event:s}]);g=f,E=!0;break}}g=E=!1}if(E&&n){var r=O._testdetect(t,u);if(e in u.evtListeners)for(c=0;c<u.evtListeners[e].func.length;c++)u.evtListeners[e].func[c].apply(u,[{target:u,mouse:r,type:e,event:s}]);if(i in u.evtListeners)for(c=0;c<u.evtListeners[i].func.length;c++)u.evtListeners[i].func[c].apply(u,[{target:u,mouse:r,type:i,event:s}]);v=u,n=r=!1;break}v=!1}}this.container.addEventListener("touchmove",t,!1),this.container.addEventListener("touchstart",t,!1),this.container.addEventListener("touchend",t,!1);var l,c,d,u,f,p,g,v,m,w,b,y,C,_,x,L,k,M,S,I,T,X,Y,O=this,E=!1,q={touchstart:null,touchend:null,touchmove:null,gestureend:null,dragstop:!1,click:!1};this._evtData=[t]},_functest:function(){function t(t){"mouseout"===t.type&&y&&o(t,y),"mouseout"===t.type&&C&&o(t,_),u=f=p=g=v=m=w=b=y=C=_=x=L=M=k=!1,T={mouseup:!1,mousedown:!1,mousemove:!1,click:!1,mouseover:!1,mouseout:!1,dragstart:!1,drag:!1,dragstop:!1}}function e(t){if(t.preventDefault(),r(t),T.click=!1,T.mouseup=!1,T.dragstop=!1,T.dragstart=!1,T.mousemove="mousemove"===t.type,n(t),a(t),"mousedown"===t.type?T.mousedown=!0:"mouseup"===t.type&&T.mousedown&&(T.mousedown=!1,T.click=!0,T.mouseup=!0,m=!1,v=!1),T.mousemove&&T.mousedown&&b&&(v=!m,w=!0),v&&b&&(m=!0),!v&&!m&&w&&T.mouseup&&(T.dragstop=!0,T.drag=!1,w=!1,T.click=!1),s(t)||i(t))for(var e in T)T[e]&&d(t,e)}function i(t){if(v&&C){var e=j._parentOffset(t,C.parent);S=e.ox-C.x,I=e.oy-C.y,l(t,C,e)}else{if(!m||!C)return!0;c(t,C,S,I)}return!1}function s(t){if(v&&b){var e=j._parentOffset(t,b.parent);X=e.ox-b.x,Y=e.oy-b.y,l(t,b,e)}else{if(!m||!b)return!0;c(t,b,X,Y)}return!1}function a(t){x=!!C,L=!!_&&_!==C,L?k||(k=!0,o(t,_),M=!1):x&&(M||(M=!0,h(t,C),k=!1)),_=x?C:_}function n(t){p=!!b,g=!!y&&y!==b,g?f||(f=!0,o(t,y),u=!1):p&&(u||(u=!0,h(t,b),f=!1)),y=p?b:y}function r(t){if(t.type in j.evtListeners)for(R=j._parentOffset(t,j),E=0;E<j.evtListeners[t.type].func.length;E++)j.evtListeners[t.type].func[E].apply(j,[{target:j,mouse:R,type:t.type,event:t}])}function h(t,e){if("mouseover"in e.evtListeners)for(R=j._parentOffset(t,e.parent),E=0;E<e.evtListeners.mouseover.func.length;E++)e.evtListeners.mouseover.func[E].apply(A,[{target:e,mouse:R,type:"mouseover",event:t}])}function o(t,e){if(e&&"mouseout"in e.evtListeners)for(R=j._parentOffset(t,e.parent),E=0;E<e.evtListeners.mouseout.func.length;E++)e.evtListeners.mouseout.func[E].apply(A,[{target:e,mouse:R,type:"mouseout",event:t}])}function l(t,e,i){if("dragstart"in e.evtListeners)for(E=0;E<e.evtListeners.dragstart.func.length;E++)e.evtListeners.dragstart.func[E].apply(A,[{target:e,mouse:i,type:"dragstart",event:t}])}function c(t,e,i,s){if("drag"in e.evtListeners){var a,n,r=j._parentOffset(t,e.parent);for(a=r.ox-i,n=r.oy-s,r.ox=a,r.oy=n,E=0;E<e.evtListeners.drag.func.length;E++)e.evtListeners.drag.func[E].apply(A,[{target:e,mouse:r,type:"drag",event:t}])}}function d(t,e,i){for(O=j.children.length-1;O>-1;O--)if(F=j.children[O],F.visible&&F.enabledEvent){for(q=F.children.length-1;q>-1;q--){if(A=F.children[q],A.visible&&A.enabledEvent&&(R=j._testdetect(t,A))){if(e in A.evtListeners)for(E=0;E<A.evtListeners[e].func.length;E++)A.evtListeners[e].func[E].apply(A,[{target:A,mouse:R,type:e,event:t}]);b=A,P=!0;break}b=P=!1}if(P&&R){if(e in F.evtListeners)for(E=0;E<F.evtListeners[e].func.length;E++)F.evtListeners[e].func[E].apply(F,[{target:F,mouse:R,type:e,event:t}]);C=F,R=!1;break}C=!1}}this.container.addEventListener("mousemove",e,!1),this.container.addEventListener("mousedown",e,!1),this.container.addEventListener("mouseup",e,!1),this.container.addEventListener("click",e,!1),this.container.addEventListener("mouseover",t,!1),this.container.addEventListener("mouseout",t,!1);var u,f,p,g,v,m,w,b,y,C,_,x,L,k,M,S,I,T={mouseup:!1,mousedown:!1,mousemove:!1,click:!1,mouseover:!1,mouseout:!1,dragstart:!1,drag:!1,dragstop:!1},X=0,Y=0;this._evtData=[e,t];var O,E,q,F,A,R,j=this,P=!1},_testdetect:function(t,e){var i,s,a,n,r,h,o,l,c,d=this.container.getBoundingClientRect();return s=t.pageX-(Math.floor(d.left)+window.pageXOffset),a=t.pageY-(Math.floor(d.top)+window.pageYOffset),i=e.parent._global(),l="Sprite"===e.className?s/i.scaleX:s,c="Sprite"===e.className?a/i.scaleY:a,r=Math.sqrt(Math.pow(l-i.x,2)+Math.pow(c-i.y,2)),n=Math.atan2(a-i.y,s-i.x)-i.rotation,h=Math.cos(n)*r,o=Math.sin(n)*r,this.fakeCtx.save(),this.fakeCtx.translate(i.x,i.y),this.fakeCtx.scale(i.scaleX,i.scaleY),this.fakeCtx.rotate(i.rotation),e.draw(this.fakeCtx,!0),this.fakeCtx.restore(),!!this.fakeCtx.isPointInPath(s,a)&&{x:s,y:a,ox:h,oy:o,gx:i.x,gy:i.y,scaleX:i.scaleX,scaleY:i.scaleY,rotation:i.rotation}},_parentOffset:function(t,e){var i,s,a,n,r,h,o,l,c,d=this.container.getBoundingClientRect();return i=e._global(),s=t.pageX-(Math.floor(d.left)+window.pageXOffset),a=t.pageY-(Math.floor(d.top)+window.pageYOffset),l="Sprite"===e.className?s/i.scaleX:s,c="Sprite"===e.className?a/i.scaleY:a,n=Math.sqrt(Math.pow(l-i.x,2)+Math.pow(c-i.y,2)),r=Math.atan2(a-i.y,s-i.x)-i.rotation,h=Math.cos(r)*n,o=Math.sin(r)*n,{x:s,y:a,ox:h,oy:o,gx:i.x,gy:i.y,scaleX:i.scaleX,scaleY:i.scaleY,rotation:i.rotation}},_global:function(){return{x:this.x,y:this.y,scaleX:this.scaleX,scaleY:this.scaleY,rotation:this.rotation,alpha:this.alpha,visible:this.visible}},clear:function(){for(var t=0;t<this.children.length;t++)this.children[t].clear()},draw:function(t){for(var e=0;e<this.children.length;e++)this.children[e].draw(t)}},Canvas2d.Sprite=function(t,e){this.enabledEvent=e!==!1||e,this.visible=!0,this.name=t?t:"",this.id="sprite_"+(Canvas2d.globalId++).toString()+"_"+this.name;var i=Canvas2d.container;this.width=i.width,this.height=i.height;var s=document.createElement("canvas");s.width=this.width,s.height=this.height,s.id=this.id,s.style.position="absolute",s.style.top="0px",s.style.left="0px",this.canvas=s,this.ctx=s.getContext("2d"),this.stage=i.element,this.className="Sprite",this.indexCount=0,this.date=new Date,this.children=[],this.index=0,this.parent=null,this.x=0,this.y=0,this.alpha=1,this.scaleX=1,this.scaleY=1,this.rotation=0,this.evtListeners={}},Canvas2d.Sprite.prototype={addEvent:function(t,e){t in this.evtListeners?this.evtListeners[t].func.push(e):this.evtListeners[t]={func:[e]}},removeEvent:function(t,e){if(t in this.evtListeners){for(var i=0;i<this.evtListeners[t].func.length;i++)if(this.evtListeners[t].func[i]===e){this.evtListeners[t].func.splice(i,1);break}0===this.evtListeners[t].func.length&&delete this.evtListeners[t]}},add:function(t){t.parent||"DisplayObjects"!==t.className||(t.parent=this,t.index=this.indexCount,this.indexCount++,this.children.push(t))},remove:function(t){if(t.parent===this){t.parent=void 0,this.children.splice(t.index,1),this.indexCount--;for(var e=0;e<this.children.length;e++)this.children[e].index=e}},getBound:function(){function t(t,e){return t-e}for(var e=[],i=[],s=0;s<this.children.length;s++)e.push(this.children[s].x+this.children[s].width),i.push(this.children[s].y+this.children[s].height);return e.sort(t),i.sort(t),{width:e[e.length-1],height:i[i.length-1]}},zOrder:function(t){if("string"==typeof t){var e=this.parent.children.length,i="top"===t?e-1:"bottom"===t?0:e-1;this.parent.children.splice(this.index,1),this.parent.children.splice(i,0,this);for(var s=0;s<e;s++)this.parent.children[s].index=s;this.parent._orderCanvases()}else if(t in this.parent.children){this.parent.children.splice(this.index,1),this.parent.children.splice(t,0,this);for(var s=0;s<this.parent.children.length;s++)this.parent.children[s].index=s;this.parent._orderCanvases()}},clear:function(){this.ctx.clearRect(0,0,this.width,this.height)},_global:function(){var t,e,i=this.parent._global();if(0!==this.parent.rotation){var s=Math.atan2(this.y,this.x)+this.parent.rotation,a=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2));t=a*Math.cos(s),e=a*Math.sin(s)}else t=this.x,e=this.y;return{x:i.x+t,y:i.y+e,scaleX:i.scaleX*this.scaleX,scaleY:i.scaleY*this.scaleY,rotation:i.rotation+this.rotation,alpha:i.alpha<1?this.alpha*i.alpha:this.alpha,visible:!!i.visible&&this.visible}},clone:function(){for(var t=new Canvas2d.Sprite,e=0;e<this.children.length;e++){var i=this.children[e].clone(this.children[e].name);t.add(i)}return t},draw:function(t){if(!this.visible)return void this.clear();var e=t?t:this.ctx;t||this.clear();var i=this._global();e.save(),e.translate(i.x,i.y),e.scale(i.scaleX,i.scaleY),e.rotate(i.rotation),e.globalAlpha=i.alpha;for(var s=0;s<this.children.length;s++)this.children[s].draw(e);e.restore()}},Canvas2d.DisplayObjects=function(t,e){this.enabledEvent=e!==!1||e,this.visible=!0,this.className="DisplayObjects",this.evtListeners={},this.parent=null,this.name=t?t:"",this.id="displayObjects_"+(Canvas2d.globalId++).toString()+"_"+this.name,this.index=0,this.type="",this.x=0,this.y=0,this.width=0,this.height=0,this.localX=0,this.localY=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.alpha=1,this.lineAlpha=1,this.color=null,this.lineColor=null,this.lineWidth=1,this.lineCap="butt",this.lineJoin="miter",this.lineMiter=10,this.backUpImage=null,this.imageData=null,this.imageCrop={dw:-1,dh:-1,dx:0,dy:0},this.doneimage=!1,this.currentFilter=null},Canvas2d.DisplayObjects.prototype={txt:"",close:!0,fontStyle:null,fontSize:10,fontType:"Verdana",fontWeight:"normal",align:"center",baseLine:"alphabetic",backGround:null,paddingLeft:0,paddingTop:0,source:null,loadComplete:!1,isLoading:!1,image:null,frameList:null,currentFrame:0,shadow:null,lineShadow:null,gradient:null,lineGradient:null,_alignList:{start:"start",end:"end",left:"left",right:"right",center:"center"},_baseList:{top:"top",hanging:"hanging",middle:"middle",alphabetic:"alphabetic",ideographic:"ideographic",bottom:"bottom"},_capList:{butt:"butt",round:"round",square:"square"},_joinList:{bevel:"bevel",round:"round",miter:"miter"},addEvent:function(t,e){t in this.evtListeners?this.evtListeners[t].func.push(e):this.evtListeners[t]={func:[e]}},removeEvent:function(t,e){if(t in this.evtListeners){for(var i=0;i<this.evtListeners[t].func.length;i++)if(this.evtListeners[t].func[i]===e){this.evtListeners[t].func.splice(i,1);break}0===this.evtListeners[t].func.length&&delete this.evtListeners[t]}},zOrder:function(t){if("string"==typeof t){var e=this.parent.children.length,i="top"===t?e-1:"bottom"===t?0:e-1;this.parent.children.splice(this.index,1),this.parent.children.splice(i,0,this);for(var s=0;s<e;s++)this.parent.children[s].index=s}else if(t in this.parent.children){this.parent.children.splice(this.index,1),this.parent.children.splice(t,0,this);for(var s=0;s<this.parent.children.length;s++)this.parent.children[s].index=s}},getColor:function(t){var e=t?t:"rgb";return this._parseGetColor(this.color,e)},getLineColor:function(t){var e=t?t:"rgb";return this._parseGetColor(this.lineColor,e)},_parseColor:function(t){if(!t)return void console.log(t," isn't a valid value.");if("string"==typeof t){var e,i,s=t.replace(/\s/g,"").toLowerCase();if(s.indexOf("rgb")>-1)return s;if(s.indexOf("#")>-1){var a=Colors.Rgb(s);return"rgb("+a[0]+","+a[1]+","+a[2]+")"}if(s.indexOf("hsl")>-1){e=/[hsla\(\)]/g,i=s.replace(e,"").split(",");var n=Colors.HslToRgb(parseFloat(i[0])/360,parseFloat(i[1])/100,parseFloat(i[2])/100);return"rgb("+n[0]+","+n[1]+","+n[2]+")"}if(s.indexOf("hsv")>-1){e=/[hsv\(\)]/g,i=s.replace(e,"").split(",");var r=Colors.HsvToRgb(parseInt(i[1]),parseInt(i[2]),parseInt(i[3]));return"rgb("+r[0]+","+r[1]+","+r[2]+")"}return s in Colors.namedColor?(i=Colors.namedColor[s][1],"rgb("+i[0]+","+i[1]+","+i[2]+")"):(console.log(t," isn't a valid value."),"rgb(0,0,0)")}return"rgb("+t[0]+","+t[1]+","+t[2]+")"},_parseGetColor:function(t,e){function i(t,e,i){var s=e-i<=t&&e+i>=t;return s}if(!t)return console.log(t," isn't a valid value."),"rgb(0,0,0)";var s,a=this._parseColor(t),n=/[rgbhslva\(\)]/g,r=a.replace(n,"").split(","),h=[parseInt(r[0]),parseInt(r[1]),parseInt(r[2])],o=h;switch(e){case"hex":o=Colors.Hex(o);break;case"rgb":o=a;break;case"hsl":s=Colors.RgbToHsl(h[0],h[1],h[2]),o="hsl("+360*s[0]+","+100*s[1]+"%,"+100*s[2]+"%)";break;case"hsv":s=Colors.RgbToHsv(h[0],h[1],h[2]),o="hsv("+360*s[0]+","+100*s[1]+"%,"+100*s[2]+"%)";break;case"name":var l=2;for(var c in Colors.namedColor)if(i(Colors.namedColor[c][1][0],o[0],l)&&i(Colors.namedColor[c][1][1],o[1],l)&&i(Colors.namedColor[c][1][2],o[2],l)){o=c;break}break;case"array":o=h;break;default:o=a}return o},cacheAsBitmap:function(){var t={polygon:"polygon",shape:"shape",text:"text",rect:"rect",rectround:"rectround",line:"line",circle:"circle"};if(!(this.type in t))return void console.log("wrong type ",this.type);var e=document.createElement("canvas"),i=this.x,s=this.y,a=this.rotation,n=new Image;e.width=this.width+2*this.lineWidth,e.height=this.height+2*this.lineWidth;var r=e.getContext("2d");"polygon"===this.type||"shape"===this.type?(i=this.x-this.width/2,s=this.y-this.height/2,this.x=Math.abs(this._coord.x[0])+this.lineWidth,this.y=Math.abs(this._coord.y[0])+this.lineWidth):(this.x=0,this.y=0),this.rotation=0,this.draw(r);var h=e.toDataURL("image/png",10);n.src=h,this.img(0,0,n,!0),this.x=i,this.y=s,this.rotation=a},clone:function(t){var e=new Canvas2d.DisplayObjects(t),i=Object.prototype.toString;for(var s in this)if("[object Function]"!==i.call(this[s]))switch(s){case"id":break;case"parent":break;case"name":break;default:if("[object Object]"===i.call(this[s])){var a={};for(var n in this[s])a[n]=this[s][n];e[s]=a}else e[s]=this[s]}return e},rect:function(t,e,i,s,a,n,r){this.type="rect",this.x=this.localX=t,this.y=this.localY=e,this.width=i,this.height=s,this._setStyle(a,n,r)},rectRound:function(t,e,i,s,a,n,r,h){this.type="rectround",this.x=this.localX=t,this.y=this.localY=e,this.width=i,this.height=s,this.radius=a,this._setStyle(n,r,h)},polygon:function(t,e,i,s,a,n,r){function h(t,e){return t-e}function o(t,e){return t>0?e-t:e<0?Math.abs(t+e):Math.abs(t)+e}this.type="polygon",this.close=r!==!1||r,this.x=this.localX=t,this.y=this.localY=e,this.points=i,this._setStyle(s,a,n);for(var l=[],c=[],d=0;d<this.points.length;d++)l.push(this.points[d][0]+this.localX),c.push(this.points[d][1]+this.localY);l.sort(h),c.sort(h),this.width=o(l[0],l[l.length-1]),this.height=o(c[0],c[c.length-1]),this._coord={x:l,y:c}},shape:function(t,e,i,s,a,n,r){function h(t,e){return t-e}function o(t,e){return t>0?e-t:e<0?Math.abs(t+e):Math.abs(t)+e}this.type="shape",this.close=r!==!1||r,this.x=this.localX=t,this.y=this.localY=e,this.obj=i,this._setStyle(s,a,n);for(var l=[],c=[],d=0;d<this.obj.length;d++)for(var u in this.obj[d]){var f=this.obj[d][u];switch(u){case"moveTo":l.push(this.localX+f[0]),c.push(this.localY+f[1]);break;case"lineTo":l.push(this.localX+f[0]),c.push(this.localY+f[1]);break;case"quadraticCurveTo":l.push(this.localX+f[0]),c.push(this.localY+f[1]),l.push(this.localX+f[2]),c.push(this.localY+f[3]);break;case"bezierCurveTo":l.push(this.localX+f[0]),c.push(this.localY+f[1]),l.push(this.localX+f[2]),c.push(this.localY+f[3]),l.push(this.localX+f[4]),c.push(this.localY+f[5]);break;case"arcTo":l.push(this.localX+f[0]),c.push(this.localY+f[1]),l.push(this.localX+f[2]),c.push(this.localY+f[3])}}l.sort(h),c.sort(h),this.width=o(l[0],l[l.length-1]),this.height=o(c[0],c[c.length-1]),this._coord={x:l,y:c}},line:function(t,e,i,s,a,n,r,h,o,l,c){function d(t,e){return t-e}function u(t,e){return t>0?e-t:e<0?Math.abs(t+e):Math.abs(t)+e}this.type="line",this.x=this.localX=t,this.y=this.localY=e,this.points=[[i,s],[a,n]];for(var f=[],p=[],g=0;g<this.points.length;g++)f.push(this.points[g][0]+this.localX),p.push(this.points[g][1]+this.localY);f.sort(d),p.sort(d),this.width=u(f[0],f[f.length-1]),this.height=u(p[0],p[p.length-1]),this._coord={x:f,y:p},this.len=Math.sqrt(Math.pow(i+a,2)+Math.pow(s+n,2)),this._setStyle(null,r,h,o,l,c)},circle:function(t,e,i,s,a,n,r,h){this.type="circle",this.x=this.localX=t,this.y=this.localY=e,this.width=2*i,this.height=2*i,this.radius=i,this.startAngle=s,this.endAngle=a,this._setStyle(n,r,h)},text:function(t,e,i,s,a,n,r,h,o,l){this.type="text",this.x=this.localX=e,this.y=this.localY=i;var c=Canvas2d.fakeCtx;this.height=a?a:10,this.txt=t?t:"",this.backGround=h?h:null,this._setFont(s,a,n,o,l),this._setStyle(r),c.font=this.fontStyle,c.textAlign=this.align,c.textBaseline=this.baseLine,this.width=c.measureText(t).width,delete c},img:function(t,e,i,s,a,n,r,h){this.type="img",this.x=this.localX=t,this.y=this.localY=e,this.paddingLeft=n?n:0,this.paddingTop=r?r:0,this._setStyle(a),this.setCrop(h),this.source=i?i:null,s&&this.loadImage(this.source,null,null,s)},clip:function(t,e,i,s,a){this.type="clip",this.x=this.localX=t,this.y=this.localY=e,this.source=i?i:null,this.frameList=s?s:this.frameList,a&&this.loadImage(this.source,null,null,a)},restore:function(){this.doneimage=!1},setCrop:function(t){if(t){for(var e in this.imageCrop)this.imageCrop[e]=t[e]?t[e]:this.imageCrop[e];this.doneimage=!1}},roulette:function(t,e,i,s,a,n){var r,h,a=a/360*(2*Math.PI),o=0,l=0,c=[],d=t*s,u=e*s,f=i*s;for(console.log(360/a*e);l<=360/a*e;)"Epicycloid"===n&&(r=(d+u)*Math.cos(o)-u*Math.cos((d+u)/u*o),h=(d+u)*Math.sin(o)-u*Math.sin((d+u)/u*o)),"Epitrochoid"===n&&(r=(d+u)*Math.cos(o)-f*Math.cos((d+u)/u*o),h=(d+u)*Math.sin(o)-f*Math.sin((d+u)/u*o)),"Hypocycloid"===n&&(r=(d-u)*Math.cos(o)+u*Math.cos((d-u)/u*o),h=(d-u)*Math.sin(o)-u*Math.sin((d-u)/u*o)),"Hypotrochoid"===n&&(r=(d-u)*Math.cos(o)+f*Math.cos((d-u)/u*o),h=(d-u)*Math.sin(o)-f*Math.sin((d-u)/u*o)),o+=a,l++,c.push([r,h]);return c},filter:function(t,e){this.backUpImage&&(this.imageData=this.backUpImage);var i=document.createElement("canvas");i.width=this.width,i.height=this.height;var s=i.getContext("2d");s.drawImage(this.imageData,0,0,this.width,this.height);var a=s.getImageData(0,0,this.width,this.height);switch(t){case"invert":a=this._filterInvert(a),this.currentFilter="invert";break;case"grayscale":a=this._filterGrayscale(a),this.currentFilter="grayscale";break;case"hsl":a=this._filterHsl(a,e),this.currentFilter="hsl";break;case"pixelated":a=this._filterPixelated(a,e,i),this.currentFilter="pixelated";break;case"cut":var n=e[1];e=4===e.length?e:Colors._parseColor(e[0]),a=this._filterCut(a,e,n),this.currentFilter="cut";break;default:this.currentFilter=null}s.putImageData(a,0,0),this.imageData=i,this.parent.draw()},_filterPixelated:function(t,e,i){for(var s=t.data,a=e?e[0]:2,n=0;n<i.height;n+=a)for(var r=0;r<i.width;r+=a)for(var h=s[4*(i.width*n+r)],o=s[4*(i.width*n+r)+1],l=s[4*(i.width*n+r)+2],c=0;c<a;c++)for(var d=0;d<a;d++)r+d<i.width&&(s[4*(i.width*(n+c)+(r+d))]=h,s[4*(i.width*(n+c)+(r+d))+1]=o,s[4*(i.width*(n+c)+(r+d))+2]=l);return t},_filterGrayscale:function(t){for(var e=t.data,i=0;i<e.length;i+=4){var s=.34*e[i]+.5*e[i+1]+.16*e[i+2];e[i]=s,e[i+1]=s,e[i+2]=s}return t},_filterInvert:function(t){for(var e=t.data,i=0;i<e.length;i+=4)e[i]=255-e[i],e[i+1]=255-e[i+1],e[i+2]=255-e[i+2];return t},_filterCut:function(t,e,i){function s(t,e,s){return s>=t-e&&s<=t+e?Math.floor(255*Math.abs((t-s)/i)):255}for(var a=t.data,n=0,r=0;r<a.length;r+=4)n=s(a[r],i,e[0])+s(a[r+1],i,e[1])+s(a[r+2],i,e[2]),a[r+3]=Math.floor(n/3);return t},_filterHsl:function(t,e){for(var i=t.data,s=0;s<i.length;s+=4){var a=Colors.RgbToHsl(i[s],i[s+1],i[s+2]),n=a[0]+e[0]/100<=0?0:a[0]+e[0]/100>=120?120:a[0]+e[0]/100,r=a[1]+e[1]/100<=0?0:a[1]+e[1]/100>=100?100:a[1]+e[1]/100,h=a[2]+e[2]/100<=0?0:a[2]+e[2]/100>=100?100:a[2]+e[2]/100,o=Colors.HslToRgb(n,r,h);i[s]=o[0],i[s+1]=o[1],i[s+2]=o[2]}return t},loadImage:function(t,e,i,s){this._progressEvent=e,this._completeEvent=i,this.source=t?t:this.source,"object"==typeof this.source?(this.image=this.source,this.width=this.image.width,this.height=this.image.height,this.isLoading=!1,this.loadComplete=!0,"clip"===this.type?this._setFrames(s):(this._completeEvent&&this._completeEvent.apply(this,[this]),s&&this.parent&&this.draw(this.parent.ctx))):this._load(s)},_load:function(t){var e=navigator.userAgent.toLowerCase(),i=/msie\s\d+\.\d+/;if(i.test(e)){var s=new Image;s.caller=this,s.show=t,this._loadStart(),s.addEventListener("load",this._loadComplete,!1),s.src=this.source}else{var a=new XMLHttpRequest;a.caller=this,a.show=t,a.onloadstart=this._loadStart,a.onprogress=this._loadProgress,a.onload=this._loadComplete,a.open("GET",this.source,!0),a.overrideMimeType("text/plain; charset=x-user-defined"),a.send(null)}},_loadStart:function(){this.loadComplete=!1},_loadProgress:function(t){this.caller._progressEvent&&this.caller._progressEvent.apply(this.caller,[t]),this.caller.isLoading=!0,this.caller.loadComplete=!1},_loadComplete:function(t){var e=navigator.userAgent.toLowerCase(),i=/msie\s\d+\.\d+/;i.test(e)?(this.caller.image=this,this.caller.width=this.caller.image.width,this.caller.height=this.caller.image.height,this.caller.isLoading=!1,this.caller.loadComplete=!0,"clip"===this.caller.type?this.caller._setFrames(this.show):(this.caller._completeEvent&&this.caller._completeEvent.apply(this.caller,[this.caller]),this.show&&this.caller.parent&&this.caller.draw(this.caller.parent.ctx))):this.caller._base64Encode(this.responseText,this.caller,this.show)},_base64Encode:function(t,e,i){function s(t){if(t){var s=new Image;s.onload=function(){e.image=s,e.width=e.image.width,e.height=e.image.height,e.isLoading=!1,e.loadComplete=!0,"clip"===e.type?e._setFrames(i):(e._completeEvent&&e._completeEvent.apply(e,[e]),i&&e.parent&&e.draw(e.parent.ctx))};var a=e.source.split("."),r="jpg"===a[a.length-1]?"jpeg":a[a.length-1];s.src="data:image/"+r+";base64,"+n}}for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="",r=0;r<t.length;){var h,o,l=255&t.charCodeAt(r++),c=255&t.charCodeAt(r++),d=255&t.charCodeAt(r++),u=l>>2,f=(3&l)<<4|c>>4;isNaN(c)?h=o=64:(h=(15&c)<<2|d>>6,o=isNaN(d)?64:63&d),n+=a.charAt(u)+a.charAt(f)+a.charAt(h)+a.charAt(o);var p=!(r<t.length);s(p)}},_setFrames:function(t){function e(){r.frameList[this.indice].data=this,this.indice===r.frameList.length-1&&(r._completeEvent&&r._completeEvent.apply(r,[r]),t&&r.parent&&r.draw(r.parent.ctx))}if(this.frameList&&"clip"===this.type){var i,s,a,n=document.createElement("canvas"),r=this;for(s=0;s<this.frameList.length;s++){n.width=this.frameList[s].map.width,n.height=this.frameList[s].map.height,this.width=this.frameList[s].map.width,this.height=this.frameList[s].map.height,i=n.getContext("2d"),i.drawImage(this.image,this.frameList[s].map.x,this.frameList[s].map.y,n.width,n.height,0,0,n.width,n.height),a=n.toDataURL("image/png");var h=new Image;h.indice=s,h.onload=e,h.src=a,i.clearRect(0,0,n.width,n.height)}}},_setStyle:function(t,e,i,s,a,n){this.color=t instanceof Array?this._parseColor(t):t,this.lineColor=e instanceof Array?this._parseColor(e):e,this.lineCap=this._capList[s]?s:"butt",this.lineJoin=this._joinList[a]?a:"miter",this.lineWidth=i?i:1,this.lineMiter=parseInt(n)?parseInt(n):10},_setLineStyle:function(t){this.lineGradient?this.lineShadow?(t.save(),t.lineWidth=this.lineWidth,t.lineCap=this.lineCap,t.lineJoin=this.lineJoin,t.miterLimit=this.lineMiter,t.shadowColor=this.lineShadow.color,t.shadowOffsetX=this.lineShadow.offsetX,t.shadowOffsetY=this.lineShadow.offsetY,t.shadowBlur=this.lineShadow.blur,this._setLineGradient(t),t.restore()):(t.lineWidth=this.lineWidth,t.lineCap=this.lineCap,t.lineJoin=this.lineJoin,t.miterLimit=this.lineMiter,this._setLineGradient(t)):this.lineShadow?(t.save(),t.lineWidth=this.lineWidth,t.lineCap=this.lineCap,t.lineJoin=this.lineJoin,t.miterLimit=this.lineMiter,t.shadowColor=this.lineShadow.color,t.shadowOffsetX=this.lineShadow.offsetX,t.shadowOffsetY=this.lineShadow.offsetY,t.shadowBlur=this.lineShadow.blur,this.lineColor&&(t.globalAlpha=this._g.lineAlpha,t.strokeStyle=Colors.ParseColor(this.lineColor),t.stroke()),t.restore()):(t.lineWidth=this.lineWidth,t.lineCap=this.lineCap,t.lineJoin=this.lineJoin,t.miterLimit=this.lineMiter,this.lineColor&&(t.globalAlpha=this._g.lineAlpha,t.strokeStyle=Colors.ParseColor(this.lineColor),t.stroke()))},_setFillStyle:function(t){this.gradient?this.shadow?(t.save(),t.shadowColor=this.shadow.color,t.shadowOffsetX=this.shadow.offsetX,t.shadowOffsetY=this.shadow.offsetY,t.shadowBlur=this.shadow.blur,this._setGradient(t),t.restore()):this._setGradient(t):this.shadow?(t.save(),t.shadowColor=this.shadow.color,t.shadowOffsetX=this.shadow.offsetX,t.shadowOffsetY=this.shadow.offsetY,t.shadowBlur=this.shadow.blur,this.color&&(t.fillStyle=this.color,t.fill()),t.restore()):this.color&&(t.fillStyle=Colors.ParseColor(this.color),t.fill())},_setFont:function(t,e,i,s,a){this.fontWeight=t?t:this.fontWeight,this.fontStyle=this.fontWeight+" "+e.toString()+"px "+i,this.fontType=i,this.fontSize=e,this.align=this._alignList[s]?s:"center",this.baseLine=this._baseList[a]?a:"alphabetic"},_setShadow:function(t){this.shadow&&(t.shadowColor=this.shadow.color,t.shadowOffsetX=this.shadow.offsetX,t.shadowOffsetY=this.shadow.offsetY,t.shadowBlur=this.shadow.blur)},_setLineShadow:function(t){this.lineShadow&&(t.shadowColor=this.lineShadow.color,t.shadowOffsetX=this.lineShadow.offsetX,t.shadowOffsetY=this.lineShadow.offsetY,t.shadowBlur=this.lineShadow.blur)},_setGradient:function(t){var e,i=this.gradient;"linear"===i.type?e=t.createLinearGradient(i.coord.x0,i.coord.y0,i.coord.x1,i.coord.y1):"radial"===i.type&&(e=t.createRadialGradient(i.coord.x0,i.coord.y0,i.coord.r0,i.coord.x1,i.coord.y1,i.coord.r1));for(var s=0;s<i.color.length;s++)e.addColorStop(i.offset[s],i.color[s]);t.fillStyle=e,t.fill()},_setLineGradient:function(t){var e,i=this.lineGradient;"linear"===i.type?e=t.createLinearGradient(i.coord.x0,i.coord.y0,i.coord.x1,i.coord.y1):"radial"===i.type&&(e=t.createRadialGradient(i.coord.x0,i.coord.y0,i.coord.r0,i.coord.x1,i.coord.y1,i.coord.r1));for(var s=0;s<i.color.length;s++)e.addColorStop(i.offset[s],i.color[s]);t.stokeStyle=e,t.stroke()},_drawRect:function(t,e){t.save(),t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),t.globalAlpha=this._g.alpha,t.beginPath(),t.rect(this.localX,this.localY,this.width,this.height),t.closePath(),e||(this._setFillStyle(t),this._setLineStyle(t)),t.restore(),this.mask&&t.clip()},_drawRoundRect:function(t,e){t.save(),t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),t.globalAlpha=this._g.alpha,t.beginPath();var i,s,a,n;i=this.localX+(this.width-this.radius),s=this.localX+this.width,a=this.localY+(this.height-this.radius),n=this.localY+this.height,t.moveTo(this.localX+this.radius,this.localY),t.lineTo(i,this.localY),t.quadraticCurveTo(s,this.localY,s,this.localY+this.radius),t.lineTo(this.localX+this.width,a),t.quadraticCurveTo(s,n,i,this.localY+this.height),t.lineTo(this.localX+this.radius,n),t.quadraticCurveTo(this.localX,n,this.localX,a),t.lineTo(this.localX,this.localY+this.radius),t.quadraticCurveTo(this.localX,this.localY,this.localX+this.radius,this.localY),t.closePath(),e||(this._setFillStyle(t),this._setLineStyle(t)),t.restore(),this.mask&&t.clip()},_drawPolygon:function(t,e){function i(t,e){return t>0?e-t:e<0?Math.abs(t+e):Math.abs(t)+e}t.save(),t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),t.globalAlpha=this._g.alpha,t.beginPath();for(var s=[],a=[],n=0;n<this.points.length;n++)0===n?t.moveTo(this.localX+this.points[n][0],this.localY+this.points[n][1]):t.lineTo(this.points[n][0]+this.localX,this.points[n][1]+this.localY),s.push(this.points[n][0]+this.localX),a.push(this.points[n][1]+this.localY);this.close&&t.closePath(),e||(this._setFillStyle(t),this._setLineStyle(t),s.sort(function(t,e){return t-e}),a.sort(function(t,e){return t-e}),this.width=i(s[0],s[s.length-1]),this.height=i(a[0],a[a.length-1]),this._coord={x:s,y:a}),t.restore(),this.mask&&t.clip()},_drawShape:function(t,e){function i(t,e){return t>0?e-t:e<0?Math.abs(t+e):Math.abs(t)+e}t.save(),t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),t.globalAlpha=this._g.alpha,t.beginPath();for(var s=[],a=[],n=0;n<this.obj.length;n++)for(var r in this.obj[n]){var h=this.obj[n][r];switch(r){case"moveTo":t.moveTo(this.localX+h[0],this.localY+h[1]),s.push(this.localX+h[0]),a.push(this.localY+h[1]);break;case"lineTo":t.lineTo(this.localX+h[0],this.localY+h[1]),s.push(this.localX+h[0]),a.push(this.localY+h[1]);break;case"quadraticCurveTo":t.quadraticCurveTo(this.localX+h[0],this.localY+h[1],this.localX+h[2],this.localY+h[3]),s.push(this.localX+h[0]),a.push(this.localY+h[1]),s.push(this.localX+h[2]),a.push(this.localY+h[3]);break;case"bezierCurveTo":t.bezierCurveTo(this.localX+h[0],this.localY+h[1],this.localX+h[2],this.localY+h[3],this.localX+h[4],this.localY+h[5]),s.push(this.localX+h[0]),a.push(this.localY+h[1]),s.push(this.localX+h[2]),a.push(this.localY+h[3]),s.push(this.localX+h[4]),a.push(this.localY+h[5]);break;case"arcTo":t.arcTo(this.localX+h[0],this.localY+h[1],this.localX+h[2],this.localY+h[3],h[4]),s.push(this.localX+h[0]),a.push(this.localY+h[1]),s.push(this.localX+h[2]),a.push(this.localY+h[3])}}this.close&&t.closePath(),e||(this._setFillStyle(t),this._setLineStyle(t),s.sort(function(t,e){return t-e}),a.sort(function(t,e){return t-e}),this.width=i(s[0],s[s.length-1]),this.height=i(a[0],a[a.length-1]),this._coord={x:s,y:a}),t.restore(),this.mask&&t.clip()},_drawLine:function(t,e){function i(t,e){return t-e}function s(t,e){return t>0?e-t:e<0?Math.abs(t+e):Math.abs(t)+e}t.save(),t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),t.globalAlpha=this._g.alpha,t.beginPath(),t.moveTo(this.points[0][0]+this.localX,this.points[0][1]+this.localY),t.lineTo(this.points[1][0]+this.localX,this.points[1][1]+this.localY),t.closePath(),this._setLineStyle(t);for(var a=[],n=[],r=0;r<this.points.length;r++)a.push(this.points[r][0]+this.localX),n.push(this.points[r][1]+this.localY);a.sort(i),n.sort(i),this.width=s(a[0],a[a.length-1]),this.height=s(n[0],n[n.length-1]),this._coord={x:a,y:n},this.len=Math.sqrt(Math.pow(a[0]+a[1],2)+Math.pow(n[0]+n[1],2)),t.restore()},_drawCircle:function(t,e){t.save(),t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),t.globalAlpha=this._g.alpha,t.beginPath(),t.arc(this.localX,this.localY,this.radius,this.startAngle,this.endAngle,!1),t.closePath(),e||(this._setFillStyle(t),this._setLineStyle(t)),t.restore(),this.mask&&t.clip()},_drawText:function(t,e){t.save(),t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),t.globalAlpha=this._g.alpha,this.fontStyle=this.fontWeight+" "+this.fontSize+"px "+this.fontType,t.font=this.fontStyle,t.textAlign=this.align,t.textBaseline=this.baseLine;var i=this.height/7,s=0;switch(this.baseLine){case"top":i=-(this.height/7);break;case"hanging":i=-(this.height/7);break;case"middle":i=this.height/7*3.5;break;case"alphabetic":i=this.height/7*5.8;break;case"ideographic":i=this.height;break;case"bottom":i=this.height;break;default:i=0}var a=t.measureText(this.txt);this.width=a.width+this.paddingLeft,"center"===this.align?s=this.width/2:"right"!==this.align&&"end"!==this.align||(s=this.width),t.beginPath(),t.rect(this.localX-s-this.paddingLeft,this.localY-i-this.paddingTop,this.width+2*this.paddingLeft,this.height+2*this.paddingTop),t.closePath(),this.backGround&&(e?t.fill():(this.backGround.color&&(t.fillStyle=this.backGround.color,t.fill()),this.backGround.lineColor&&(t.lineWidth=this.backGround.lineWidth?this.backGround.lineWidth:2,t.strokeStyle=this.backGround.lineColor,t.stroke()))),e||(t.beginPath(),this.color&&(this.gradient?(t.save(),this.shadow&&this._setShadow(t),this._setGradient(t),t.fillText(this.txt,this.localX,this.localY),t.restore()):(t.save(),this.shadow&&this._setShadow(t),t.fillStyle=this.color,t.fillText(this.txt,this.localX,this.localY),t.restore())),this.lineColor&&(t.lineWidth=this.lineWidth,t.lineCap=this.lineCap,t.lineJoin=this.lineJoin,t.miterLimit=this.lineMiter,t.strokeStyle=this.lineColor,this.lineGradient?(t.save(),this.lineShadow&&this._setLineShadow(t),this._setLineGradient(t),t.strokeText(this.txt,this.localX,this.localY),t.restore()):(t.save(),this.lineShadow&&this._setLineShadow(t),t.strokeStyle=this.lineColor,t.strokeText(this.txt,this.localX,this.localY),t.restore())),t.closePath()),t.restore(),this.mask&&t.clip()},_drawImage:function(t,e){if(t.save(),t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),t.globalAlpha=this._g.alpha,this.loadComplete&&this.image&&(this.width=this.imageCrop.dw===-1?this.width:this.imageCrop.dw,this.height=this.imageCrop.dh===-1?this.height:this.imageCrop.dh,t.beginPath(),t.rect(this.localX-this.paddingLeft,this.localY-this.paddingTop,this.width+2*this.paddingLeft,this.height+2*this.paddingTop),t.closePath(),!e)){if(this._setFillStyle(t),this._setLineStyle(t),this._setShadow(t),t.beginPath(),!this.doneimage){this.doneimage=!0,this.currentFilter=null;var i=document.createElement("canvas");i.width=this.width,i.height=this.height;var s=i.getContext("2d");s.drawImage(this.image,this.imageCrop.dx,this.imageCrop.dy,this.width,this.height,0,0,this.width,this.height),this.imageData=i,this.backUpImage=i}t.drawImage(this.imageData,this.localX,this.localY,this.width,this.height),t.closePath()}t.restore()},_drawClip:function(t,e){this.frameList&&(t.save(),t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),t.globalAlpha=this._g.alpha,this.loadComplete&&this.image&&this.frameList[this.currentFrame].data&&(t.beginPath(),t.rect(this.localX,this.localY,this.frameList[this.currentFrame].map.width,this.frameList[this.currentFrame].map.height),t.closePath(),e||(this._setFillStyle(t),this._setLineStyle(t),this._setShadow(t),t.beginPath(),t.drawImage(this.frameList[this.currentFrame].data,this.localX+this.frameList[this.currentFrame].x,this.localY+this.frameList[this.currentFrame].y),t.closePath())),t.restore())},_global:function(){var t=this.parent._global();return{x:this.x,y:this.y,scaleX:this.scaleX,scaleY:this.scaleY,rotation:t.rotation+this.rotation,alpha:t.alpha<1?this.alpha*t.alpha:this.alpha,lineAlpha:t.alpha<1?this.lineAlpha*t.alpha:this.lineAlpha,visible:!!t.visible&&this.visible}},draw:function(t,e){if(this._g=this._global(),this._g.visible)switch(this.type){case"rect":this._drawRect(t,e);break;case"rectround":this._drawRoundRect(t,e);break;case"polygon":this._drawPolygon(t,e);break;case"shape":this._drawShape(t,e);break;case"line":this._drawLine(t,e);break;case"circle":this._drawCircle(t,e);break;case"text":this._drawText(t,e);break;case"img":this._drawImage(t,e);break;case"clip":this._drawClip(t,e);break;default:console.log("default displayObject")}}},Canvas2d.Tweener=function(){this.className="Tweener",this.children={},this._tempChildren={},this.charList=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"," ","0","1","2","3","4","5","6","7","8","9",",",'"',"'",",",":",";","(",")","[","]","{","}","*","@",".","!","?","\\","/","<",">","#","+","-","_","=","^","ì","è","é","ò","à","ù","&","$","£","|","∞","°","ç"]},Canvas2d.Tweener.prototype={getFrame:function(){return window[Canvas2d.wn+"rqanim"].getFrame()},getTime:function(){return window[Canvas2d.wn+"rqanim"].getTime()},getFps:function(){return window[Canvas2d.wn+"rqanim"].getFps()},getTimeInterval:function(){return window[Canvas2d.wn+"rqanim"].getTimeInterval()},addTweener:function(t,e){if(null===t.parent||void 0===t.parent)return void console.log(typeof t.parent,"provide a nested object");var i,s,a,n,r,h,o,l,c,d,u={},f=["x","y","width","height","rotation","scaleX","scaleY","lineWidth","fontSize","radius","startAngle","endAngle"],p=e.data?e.data:null,g=e.delay?e.delay:0,v=e.ease?e.ease:"easeNone",m=e.duration?e.duration:1e3;for(var w in e)for(var b=0;b<f.length;b++)w===f[b]&&(i=e[w]>t[w]?e[w]-t[w]:-(t[w]-e[w]),u[w]={ease:v,to:i,ct:0,d:m,from:t[w],prop:w,request:e[w],target:t});if("obj"in e){if(!t.obj)return;u.obj={ease:v,to:[],ct:0,d:m,from:[],prop:"obj",subprop:[],index:[],request:[],target:t};for(var y in e.obj)for(var C in e.obj[y])for(var _=0;_<e.obj[y][C].length;_++)u.obj.index.push(parseInt(y)),u.obj.request.push(e.obj[y][C][_]),u.obj.from.push(t.obj[y][C][_]),i=e.obj[y][C][_]>t.obj[y][C][_]?e.obj[y][C][_]-t.obj[y][C][_]:-(t.obj[y][C][_]-e.obj[y][C][_]),u.obj.to.push(i),u.obj.subprop.push(C)}if("txt"in e){if(""===t.txt)return;e.txt=""!==e.txt?e.txt:"cutFwd",a=[];var x=[];for(n=t.txt,w=0;w<this.charList.length;w++)x.push(this.charList[w]);for(x=this._shuffle(x),w=0;w<n.length;w++)for(i=0;i<x.length;i++)if(n.charAt(w)===x[i]){a.push(i);break}u.txt={ease:v,to:n.length,ct:0,d:m,from:0,prop:"txt",subprop:a,request:"",target:t,text:t.txt,type:e.txt,charlist:x},t._prevTxt=t.txt,t.txt=""}if("shadow"in e){if(!t.shadow)return;u.shadow={ease:v,to:[],ct:0,d:m,from:[],prop:"shadow",subprop:[],request:[],target:t};for(var y in e.shadow)"color"===y?(s=Colors._parseColor(e.shadow[y]),d=Colors._parseColor(t.shadow[y]),a=s[0]-d[0],n=s[1]-d[1],r=s[2]-d[2],u.shadow.to.push([a,n,r]),u.shadow.from.push([d[0],d[1],d[2]]),u.shadow.subprop.push(y),u.shadow.request.push(e.shadow[y])):(i=e.shadow[y]>t.shadow[y]?e.shadow[y]-t.shadow[y]:-(t.shadow[y]-e.shadow[y]),u.shadow.to.push(i),u.shadow.from.push(t.shadow[y]),u.shadow.subprop.push(y),u.shadow.request.push(e.shadow[y]))}if("lineShadow"in e){if(!t.lineShadow)return;u.lineShadow={ease:v,to:[],ct:0,d:m,from:[],prop:"lineShadow",subprop:[],request:[],target:t};for(var L in e.lineShadow)"color"===L?(s=Colors._parseColor(e.lineShadow[L]),d=Colors._parseColor(t.lineShadow[L]),a=s[0]-d[0],n=s[1]-d[1],r=s[2]-d[2],u.lineShadow.to.push([a,n,r]),u.lineShadow.from.push([d[0],d[1],d[2]]),u.lineShadow.subprop.push(L),u.lineShadow.request.push(e.lineShadow[L])):(i=e.lineShadow[L]>t.lineShadow[L]?e.lineShadow[L]-t.lineShadow[L]:-(t.lineShadow[L]-e.lineShadow[L]),u.lineShadow.to.push(i),u.lineShadow.from.push(t.lineShadow[L]),u.lineShadow.subprop.push(L),u.lineShadow.request.push(e.lineShadow[L]))}"color"in e&&(s=Colors._parseColor(e.color),d=Colors._parseColor(t.color),a=s[0]-d[0],n=s[1]-d[1],r=s[2]-d[2],u.rgb={ease:v,tor:a,tog:n,tob:r,ct:0,d:m,fromr:d[0],fromg:d[1],fromb:d[2],prop:"color",request:s,target:t}),"lineColor"in e&&(s=Colors._parseColor(e.lineColor),d=Colors._parseColor(t.lineColor),a=s[0]-d[0],n=s[1]-d[1],r=s[2]-d[2],u.rgbl={ease:v,tor:a,tog:n,tob:r,ct:0,d:m,fromr:d[0],fromg:d[1],fromb:d[2],prop:"lineColor",request:s,target:t}),"alpha"in e&&(h=e.alpha,l=h-t.alpha,u.alpha={ease:v,to:l,ct:0,d:m,from:t.alpha,prop:"alpha",request:h,target:t}),"lineAlpha"in e&&(h=e.lineAlpha>1?e.lineAlpha/100:e.lineAlpha,c=h-t.lineAlpha,u.lineAlpha={ease:v,to:c,ct:0,d:m,from:t.lineAlpha,prop:"lineAlpha",request:o,target:t});var k=e.onStart?e.onStart:null,M=e.onTween?e.onTween:null,S=e.onEnd?e.onEnd:null;u.state={start:!0,tweening:!1,end:!1,onStart:k,onTween:M,onEnd:S,target:t,duration:m,delay:g,data:p},g>0?this._delayFun(this.children,u,t.id,g):this._startFun(this.children,u,t.id)},_delayFun:function(t,e,i,s){var a=this;setTimeout(function(){a._startFun(t,e,i)},s)},_startFun:function(t,e,i){t[i]=e,window[Canvas2d.wn+"rqanim"].addLoop(this,this._callTween)},removeTweener:function(t){t.id in this._tempChildren&&delete this._tempChildren[t.id],t.id in this.children&&(this.children[t.id].state.end=!0)},_shuffle:function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(Math.random()*(e+1)),s=t[e];t[e]=t[i],t[i]=s}return t},_callTween:function(t){var e,i,s={};for(var a in t.children){if(t.children[a].state.start)t._states(t.children[a].state),t.children[a].state.start=!1;else{if(t.children[a].state.end){t.children[a].state.tweening=!1,i=t.children[a].state,delete t.children[a],t._states(i);for(e in t.children);t.children[a]||t.children[e]||window[Canvas2d.wn+"rqanim"].removeLoop(t);continue}t.children[a].state.tweening=!0}t._states(t.children[a].state);for(var n in t.children[a])if("state"!==n){var r=window[Canvas2d.wn+"rqanim"].getTimeInterval();"rgb"===n||"rgbl"===n?(t.children[a][n].ct+=r,t._tweenColor(t.children[a][n],t.children[a].state)):"shadow"===n||"lineShadow"===n?(t.children[a][n].ct+=r,t._tweenS(t.children[a][n],t.children[a].state)):"obj"===n?(t.children[a][n].ct+=r,t._tweenO(t.children[a][n],t.children[a].state)):"txt"===n?(t.children[a][n].ct+=r,t._tweenT(t.children[a][n],t.children[a].state)):(t.children[a][n].ct+=r,t._tween(t.children[a][n],t.children[a].state))}"DisplayObjects"===t.children[a].state.target.className?s[t.children[a].state.target.parent.id]=t.children[a].state.target.parent:s[t.children[a].state.target.id]=t.children[a].state.target}for(var h in s)s[h].draw()},_tweenColor:function(t,e){t.ct/t.d>=1&&(t.ct=1,t.d=1,e.end=!0);var i,s,a;i=this[t.ease](t.ct,t.fromr,t.tor,t.d),s=this[t.ease](t.ct,t.fromg,t.tog,t.d),a=this[t.ease](t.ct,t.fromb,t.tob,t.d),t.target[t.prop]="rgb("+Math.round(i)+","+Math.round(s)+","+Math.round(a)+")"},_tween:function(t,e){t.ct/t.d>=1&&(t.ct=1,t.d=1,e.end=!0);var i;i=this[t.ease](t.ct,t.from,t.to,t.d),t.target[t.prop]=i},_tweenS:function(t,e){t.ct/t.d>=1&&(t.ct=1,t.d=1,e.end=!0);for(var i=0;i<t.to.length;i++)if("color"===t.subprop[i]){var s,a,n;s=this[t.ease](t.ct,t.from[i][0],t.to[i][0],t.d),a=this[t.ease](t.ct,t.from[i][1],t.to[i][1],t.d),n=this[t.ease](t.ct,t.from[i][2],t.to[i][2],t.d),t.target[t.prop][t.subprop[i]]="rgb("+Math.round(s)+","+Math.round(a)+","+Math.round(n)+")"}else{var r;r=this[t.ease](t.ct,t.from[i],t.to[i],t.d),t.target[t.prop][t.subprop[i]]=r}},_tweenO:function(t,e){t.ct/t.d>=1&&(t.ct=1,t.d=1,e.end=!0);for(var i=0;i<t.to.length;i++){var s;s=this[t.ease](t.ct,t.from[i],t.to[i],t.d),t.target[t.prop][t.index[i]][t.subprop[i]][i]=s}},_tweenT:function(t,e){t.ct/t.d>=1&&(t.ct=1,t.d=1,e.end=!0);var i;switch(t.type){case"cutFwd":i=Math.floor(this[t.ease](t.ct,t.from,t.to,t.d)),t.target[t.prop]=t.text.substr(0,i);break;case"cutBack":i=Math.floor(this[t.ease](t.ct,t.from,t.to,t.d)),t.target[t.prop]=t.text.substr(0,t.to-i);break;case"matrix":for(var s=0;s<t.subprop.length;s++)i=Math.floor(this[t.ease](t.ct,0,t.subprop[s],t.d)),i=i>this.charList.length-1?i-this.charList.length:i,t.request+=t.charlist[i];t.target[t.prop]=t.text=t.request,t.request=""}},_states:function(t){for(var e in t)switch(e){case"start":t[e]===!0&&t.onStart&&t.onStart.apply(t.target,[t]);break;case"tweening":t[e]===!0&&t.onTween&&t.onTween.apply(t.target,[t]);break;case"end":t[e]===!0&&t.onEnd&&t.onEnd.apply(t.target,[t])}},easeNone:function(t,e,i,s,a){return i*t/s+e},easeSine:function(t,e,i,s,a){return e+i*Math.sin(Math.PI/s*t)},easeInQuad:function(t,e,i,s,a){return i*(t/=s)*t+e},easeOutQuad:function(t,e,i,s,a){return-i*(t/=s)*(t-2)+e},easeInOutQuad:function(t,e,i,s,a){return(t/=s/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},easeOutInQuad:function(t,e,i,s,a){return t<s/2?this.easeOutQuad(2*t,e,i/2,s,a):this.easeInQuad(2*t-s,e+i/2,i/2,s,a)},easeInCubic:function(t,e,i,s,a){return i*(t/=s)*t*t+e},easeOutCubic:function(t,e,i,s,a){return i*((t=t/s-1)*t*t+1)+e},easeInOutCubic:function(t,e,i,s,a){return(t/=s/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},easeOutInCubic:function(t,e,i,s,a){return t<s/2?this.easeOutCubic(2*t,e,i/2,s,a):this.easeInCubic(2*t-s,e+i/2,i/2,s,a)},easeInQuart:function(t,e,i,s,a){return i*(t/=s)*t*t*t+e},easeOutQuart:function(t,e,i,s,a){return-i*((t=t/s-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,i,s,a){return(t/=s/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},easeOutInQuart:function(t,e,i,s,a){return t<s/2?this.easeOutQuart(2*t,e,i/2,s,a):this.easeInQuart(2*t-s,e+i/2,i/2,s,a)},easeInQuint:function(t,e,i,s,a){return i*(t/=s)*t*t*t*t+e},easeOutQuint:function(t,e,i,s,a){return i*((t=t/s-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,i,s,a){return(t/=s/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},easeOutInQuint:function(t,e,i,s,a){return t<s/2?this.easeOutQuint(2*t,e,i/2,s,a):this.easeInQuint(2*t-s,e+i/2,i/2,s,a)},easeInSine:function(t,e,i,s,a){return-i*Math.cos(t/s*(Math.PI/2))+i+e},easeOutSine:function(t,e,i,s,a){return i*Math.sin(t/s*(Math.PI/2))+e},easeInOutSine:function(t,e,i,s,a){return-i/2*(Math.cos(Math.PI*t/s)-1)+e},easeOutInSine:function(t,e,i,s,a){return t<s/2?this.easeOutSine(2*t,e,i/2,s,a):this.easeInSine(2*t-s,e+i/2,i/2,s,a)},easeInExpo:function(t,e,i,s,a){return 0===t?e:i*Math.pow(2,10*(t/s-1))+e-.001*i},easeOutExpo:function(t,e,i,s,a){return t===s?e+i:1.001*i*(-Math.pow(2,-10*t/s)+1)+e},easeInOutExpo:function(t,e,i,s,a){return 0===t?e:t===s?e+i:(t/=s/2)<1?i/2*Math.pow(2,10*(t-1))+e-5e-4*i:i/2*1.0005*(-Math.pow(2,-10*--t)+2)+e},easeOutInExpo:function(t,e,i,s,a){return t<s/2?this.easeOutExpo(2*t,e,i/2,s,a):this.easeInExpo(2*t-s,e+i/2,i/2,s,a)},easeInCirc:function(t,e,i,s,a){return-i*(Math.sqrt(1-(t/=s)*t)-1)+e},easeOutCirc:function(t,e,i,s,a){return i*Math.sqrt(1-(t=t/s-1)*t)+e},easeInOutCirc:function(t,e,i,s,a){return(t/=s/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeOutInCirc:function(t,e,i,s,a){return t<s/2?this.easeOutCirc(2*t,e,i/2,s,a):this.easeInCirc(2*t-s,e+i/2,i/2,s,a)},easeInElastic:function(t,e,i,s,a){if(0===t)return e;if(1===(t/=s))return e+i;var n,r=!a||isNaN(a.period)?.3*s:a.period,h=!a||isNaN(a.amplitude)?0:a.amplitude;return!h||h<Math.abs(i)?(h=i,n=r/4):n=r/(2*Math.PI)*Math.asin(i/h),-(h*Math.pow(2,10*(t-=1))*Math.sin((t*s-n)*(2*Math.PI)/r))+e},easeOutElastic:function(t,e,i,s,a){if(0===t)return e;if(1===(t/=s))return e+i;var n,r=!a||isNaN(a.period)?.3*s:a.period,h=!a||isNaN(a.amplitude)?0:a.amplitude;return!h||h<Math.abs(i)?(h=i,n=r/4):n=r/(2*Math.PI)*Math.asin(i/h),h*Math.pow(2,-10*t)*Math.sin((t*s-n)*(2*Math.PI)/r)+i+e},easeInOutElastic:function(t,e,i,s,a){if(0===t)return e;if(2===(t/=s/2))return e+i;var n,r=!a||isNaN(a.period)?s*(.3*1.5):a.period,h=!a||isNaN(a.amplitude)?0:a.amplitude;return!h||h<Math.abs(i)?(h=i,n=r/4):n=r/(2*Math.PI)*Math.asin(i/h),t<1?-.5*(h*Math.pow(2,10*(t-=1))*Math.sin((t*s-n)*(2*Math.PI)/r))+e:h*Math.pow(2,-10*(t-=1))*Math.sin((t*s-n)*(2*Math.PI)/r)*.5+i+e},easeOutInElastic:function(t,e,i,s,a){return t<s/2?this.easeOutElastic(2*t,e,i/2,s,a):this.easeInElastic(2*t-s,e+i/2,i/2,s,a)},easeInBack:function(t,e,i,s,a){var n=!a||isNaN(a.overshoot)?1.70158:a.overshoot;return i*(t/=s)*t*((n+1)*t-n)+e},easeOutBack:function(t,e,i,s,a){var n=!a||isNaN(a.overshoot)?1.70158:a.overshoot;return i*((t=t/s-1)*t*((n+1)*t+n)+1)+e},easeInOutBack:function(t,e,i,s,a){var n=!a||isNaN(a.overshoot)?1.70158:a.overshoot;return(t/=s/2)<1?i/2*(t*t*(((n*=1.525)+1)*t-n))+e:i/2*((t-=2)*t*(((n*=1.525)+1)*t+n)+2)+e},easeOutInBack:function(t,e,i,s,a){return t<s/2?this.easeOutBack(2*t,e,i/2,s,a):this.easeInBack(2*t-s,e+i/2,i/2,s,a)},easeInBounce:function(t,e,i,s,a){return i-this.easeOutBounce(s-t,0,i,s)+e},easeOutBounce:function(t,e,i,s,a){return(t/=s)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,e,i,s,a){return t<s/2?.5*this.easeInBounce(2*t,0,i,s)+e:.5*this.easeOutBounce(2*t-s,0,i,s)+.5*i+e},easeOutInBounce:function(t,e,i,s,a){return t<s/2?this.easeOutBounce(2*t,e,i/2,s,a):this.easeInBounce(2*t-s,e+i/2,i/2,s,a)}};var Colors={Rgb:function(t){return[this._toR(t),this._toG(t),this._toB(t)]},_toR:function(t){return parseInt(this._cutHex(t).substring(0,2),16)},_toG:function(t){return parseInt(this._cutHex(t).substring(2,4),16)},_toB:function(t){return parseInt(this._cutHex(t).substring(4,6),16)},_cutHex:function(t){return"#"===t.charAt(0)?t.substring(1,7):t},Hex:function(t){return"#"+this._toHex(t[0])+this._toHex(t[1])+this._toHex(t[2])},_toHex:function(t){return null===t?"00":(t=parseInt(t),0===t||isNaN(t)?"00":(t=Math.max(0,t),t=Math.min(t,255),t=Math.round(t),"0123456789ABCDEF".charAt((t-t%16)/16)+"0123456789ABCDEF".charAt(t%16)))},RgbToHsl:function(t,e,i){t/=255,e/=255,i/=255;var s,a,n=Math.max(t,e,i),r=Math.min(t,e,i),h=(n+r)/2;if(n===r)s=a=0;else{var o=n-r;switch(a=h>.5?o/(2-n-r):o/(n+r),n){case t:s=(e-i)/o+(e<i?6:0);break;case e:s=(i-t)/o+2;break;case i:s=(t-e)/o+4}s/=6}return[s,a,h]},HslToRgb:function(t,e,i){function s(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}var a,n,r;if(0===e)a=n=r=i;else{var h=i<.5?i*(1+e):i+e-i*e,o=2*i-h;a=s(o,h,t+1/3),n=s(o,h,t),r=s(o,h,t-1/3)}return[Math.round(255*a),Math.round(255*n),Math.round(255*r)]},RgbToHsv:function(t,e,i){t/=255,e/=255,i/=255;var s,a,n=Math.max(t,e,i),r=Math.min(t,e,i),h=n,o=n-r;if(a=0===n?0:o/n,n===r)s=0;else{switch(n){case t:s=(e-i)/o+(e<i?6:0);break;case e:s=(i-t)/o+2;break;case i:s=(t-e)/o+4}s/=6}return[s,a,h]},HsvToRgb:function(t,e,i){var s,a,n,r=Math.floor(6*t),h=6*t-r,o=i*(1-e),l=i*(1-h*e),c=i*(1-(1-h)*e);switch(r%6){case 0:s=i,a=c,n=o;break;case 1:s=l,a=i,n=o;break;case 2:s=o,a=i,n=c;break;case 3:s=o,a=l,n=i;break;case 4:s=c,a=o,n=i;break;case 5:s=i,a=o,n=l}return[Math.round(255*s),Math.round(255*a),Math.round(255*n)]},RandomRgb:function(t){var e=t?t:"string",i=Math.round(255*Math.random()),s=Math.round(255*Math.random()),a=Math.round(255*Math.random());return"array"===e?[Math.round(255*Math.random()),Math.round(255*Math.random()),Math.round(255*Math.random())]:"rgb("+i+","+s+","+a+")"},ParseColor:function(t){if(!t)return void console.log(t," isn't a valid value.");if("string"==typeof t){var e,i,s=t.replace(/\s/g,"").toLowerCase();if(s.indexOf("rgb")>-1)return s;if(s.indexOf("#")>-1){var a=this.Rgb(s);return"rgb("+a[0]+","+a[1]+","+a[2]+")"}if(s.indexOf("hsl")>-1){e=/[hsla\(\)]/g,i=s.replace(e,"").split(",");var n=this.HslToRgb(parseFloat(i[0])/360,parseFloat(i[1])/100,parseFloat(i[2])/100);return"rgb("+n[0]+","+n[1]+","+n[2]+")"}if(s.indexOf("hsv")>-1){e=/[hsv\(\)]/g,i=s.replace(e,"").split(",");var r=this.HsvToRgb(parseInt(i[1]),parseInt(i[2]),parseInt(i[3]));return"rgb("+r[0]+","+r[1]+","+r[2]+")"}return s in this.namedColor?(i=this.namedColor[s][1],"rgb("+i[0]+","+i[1]+","+i[2]+")"):(console.log(t," isn't a valid value."),"rgb(0,0,0)")}return"rgb("+t[0]+","+t[1]+","+t[2]+")"},_parseColor:function(t){if(!t)return[0,0,0];if("string"==typeof t){var e,i,s=t.replace(/\s/g,"").toLowerCase();if(s.indexOf("rgb")>-1)return e=/[rgba\(\)]/g,i=s.replace(e,"").split(","),[parseInt(i[0]),parseInt(i[1]),parseInt(i[2])];if(s.indexOf("#")>-1){var a=this.Rgb(s);return a}if(s.indexOf("hsl")>-1){e=/[hsla\(\)]/g,i=s.replace(e,"").split(",");var n=this.HslToRgb(i[0]/360,i[1]/100,i[2]/100);return n}if(s.indexOf("hsv")>-1){e=/[hsva\(\)]/g,i=s.replace(e,"").split(",");var r=this.HsvToRgb(i[0]/360,i[1]/100,i[2]/100);return r}return s in this.namedColor?i=this.namedColor[s][1]:[0,0,0]}return t},Invert:function(t){var e=this._parseColor(t);return[255-e[0],255-e[1],255-e[2]]},Complementary:function(t){var e,i=this._parseColor(t);return e=this.RgbToHsl(i[0],i[1],i[2]),i=this.HslToRgb(e[0]+.5>1?1-(e[0]+.5):e[0]+.5,e[1],e[2]),"rgb("+i[0]+","+i[1]+","+i[2]+")"},HueShift:function(t,e){for(t+=e;t>=360;)t-=360;for(;t<0;)t+=360;return t},namedColor:{aliceblue:["#f0f8ff",[240,248,255]],antiquewhite:["#faebd7",[250,235,215]],aqua:["#00ffff",[0,255,255]],aquamarine:["#7fffd4",[127,255,212]],azure:["#f0ffff",[240,255,255]],beige:["#f5f5dc",[245,245,220]],bisque:["#ffe4c4",[255,228,196]],black:["#000000",[0,0,0]],blanchedalmond:["#ffebcd",[255,235,205]],blue:["#0000ff",[0,0,255]],blueviolet:["#8a2be2",[138,43,226]],brown:["#a52a2a",[165,42,42]],burlywood:["#deb887",[222,184,135]],cadetblue:["#5f9ea0",[95,158,160]],chartreuse:["#7fff00",[127,255,0]],chocolate:["#d2691e",[210,105,30]],coral:["#ff7f50",[255,127,80]],cornflowerblue:["#6495ed",[100,149,237]],cornsilk:["#fff8dc",[255,248,220]],crimson:["#dc143c",[220,20,60]],cyan:["#00ffff",[0,255,255]],darkblue:["#00008b",[0,0,139]],darkcyan:["#008b8b",[0,139,139]],darkgoldenrod:["#b8860b",[184,134,11]],darkgray:["#a9a9a9",[169,169,169]],darkgreen:["#006400",[0,100,0]],darkgrey:["#a9a9a9",[169,169,169]],darkkhaki:["#bdb76b",[189,183,107]],darkmagenta:["#8b008b",[139,0,139]],darkolivegreen:["#556b2f",[85,107,47]],darkorange:["#ff8c00",[255,140,0]],darkorchid:["#9932cc",[153,50,204]],darkred:["#8b0000",[139,0,0]],darksalmon:["#e9967a",[233,150,122]],darkseagreen:["#8fbc8f",[143,188,143]],darkslateblue:["#483d8b",[72,61,139]],darkslategray:["#2f4f4f",[47,79,79]],darkslategrey:["#2f4f4f",[47,79,79]],darkturquoise:["#00ced1",[0,206,209]],darkviolet:["#9400d3",[148,0,211]],deeppink:["#ff1493",[255,20,147]],deepskyblue:["#00bfff",[0,191,255]],dimgray:["#696969",[105,105,105]],dimgrey:["#696969",[105,105,105]],dodgerblue:["#1e90ff",[30,144,255]],firebrick:["#b22222",[178,34,34]],floralwhite:["#fffaf0",[255,250,240]],forestgreen:["#228b22",[34,139,34]],fuchsia:["#ff00ff",[255,0,255]],gainsboro:["#dcdcdc",[220,220,220]],ghostwhite:["#f8f8ff",[248,248,255]],gold:["#ffd700",[255,215,0]],goldenrod:["#daa520",[218,165,32]],gray:["#808080",[128,128,128]],green:["#008000",[0,128,0]],greenyellow:["#adff2f",[173,255,47]],grey:["#808080",[128,128,128]],honeydew:["#f0fff0",[240,255,240]],hotpink:["#ff69b4",[255,105,180]],indianred:["#cd5c5c",[205,92,92]],indigo:["#4b0082",[75,0,130]],ivory:["#fffff0",[255,255,240]],khaki:["#f0e68c",[240,230,140]],lavender:["#e6e6fa",[230,230,250]],lavenderblush:["#fff0f5",[255,240,245]],lawngreen:["#7cfc00",[124,252,0]],lemonchiffon:["#fffacd",[255,250,205]],lightblue:["#add8e6",[173,216,230]],lightcoral:["#f08080",[240,128,128]],lightcyan:["#e0ffff",[224,255,255]],lightgoldenrodyellow:["#fafad2",[250,250,210]],lightgray:["#d3d3d3",[211,211,211]],lightgreen:["#90ee90",[144,238,144]],lightgrey:["#d3d3d3",[211,211,211]],lightpink:["#ffb6c1",[255,182,193]],lightsalmon:["#ffa07a",[255,160,122]],lightseagreen:["#20b2aa",[32,178,170]],lightskyblue:["#87cefa",[135,206,250]],lightslategray:["#778899",[119,136,153]],lightslategrey:["#778899",[119,136,153]],lightsteelblue:["#b0c4de",[176,196,222]],lightyellow:["#ffffe0",[255,255,224]],lime:["#00ff00",[0,255,0]],limegreen:["#32cd32",[50,205,50]],linen:["#faf0e6",[250,240,230]],magenta:["#ff00ff",[255,0,255]],maroon:["#800000",[128,0,0]],mediumaquamarine:["#66cdaa",[102,205,170]],mediumblue:["#0000cd",[0,0,205]],mediumorchid:["#ba55d3",[186,85,211]],mediumpurple:["#9370db",[147,112,219]],mediumseagreen:["#3cb371",[60,179,113]],mediumslateblue:["#7b68ee",[123,104,238]],mediumspringgreen:["#00fa9a",[0,250,154]],mediumturquoise:["#48d1cc",[72,209,204]],mediumvioletred:["#c71585",[199,21,133]],midnightblue:["#191970",[25,25,112]],mintcream:["#f5fffa",[245,255,250]],mistyrose:["#ffe4e1",[255,228,225]],moccasin:["#ffe4b5",[255,228,181]],navajowhite:["#ffdead",[255,222,173]],navy:["#000080",[0,0,128]],oldlace:["#fdf5e6",[253,245,230]],olive:["#808000",[128,128,0]],olivedrab:["#6b8e23",[107,142,35]],orange:["#ffa500",[255,165,0]],orangered:["#ff4500",[255,69,0]],orchid:["#da70d6",[218,112,214]],palegoldenrod:["#eee8aa",[238,232,170]],palegreen:["#98fb98",[152,251,152]],paleturquoise:["#afeeee",[175,238,238]],palevioletred:["#db7093",[219,112,147]],papayawhip:["#ffefd5",[255,239,213]],peachpuff:["#ffdab9",[255,218,185]],peru:["#cd853f",[205,133,63]],pink:["#ffc0cb",[255,192,203]],plum:["#dda0dd",[221,160,221]],powderblue:["#b0e0e6",[176,224,230]],purple:["#800080",[128,0,128]],red:["#ff0000",[255,0,0]],rosybrown:["#bc8f8f",[188,143,143]],royalblue:["#4169e1",[65,105,225]],saddlebrown:["#8b4513",[139,69,19]],salmon:["#fa8072",[250,128,114]],sandybrown:["#f4a460",[244,164,96]],seagreen:["#2e8b57",[46,139,87]],seashell:["#fff5ee",[255,245,238]],sienna:["#a0522d",[160,82,45]],silver:["#c0c0c0",[192,192,192]],skyblue:["#87ceeb",[135,206,235]],slateblue:["#6a5acd",[106,90,205]],slategray:["#708090",[112,128,144]],slategrey:["#708090",[112,128,144]],snow:["#fffafa",[255,250,250]],springgreen:["#00ff7f",[0,255,127]],steelblue:["#4682b4",[70,130,180]],tan:["#d2b48c",[210,180,140]],teal:["#008080",[0,128,128]],thistle:["#d8bfd8",[216,191,216]],tomato:["#ff6347",[255,99,71]],turquoise:["#40e0d0",[64,224,208]],violet:["#ee82ee",[238,130,238]],wheat:["#f5deb3",[245,222,179]],white:["#ffffff",[255,255,255]],whitesmoke:["#f5f5f5",[245,245,245]],yellow:["#ffff00",[255,255,0]],yellowgreen:["#9acd32",[154,205,50]]}};